<UserControl x:Class="SmugControl.Views.WidgetServerView"  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="clr-namespace:SmugControl.Views" Margin="4"
    xmlns:Converters="clr-namespace:SmugControl.Converters" xmlns:hc="https://handyorg.github.io/handycontrol"
    mc:Ignorable="d" Height="150" Width="150" MouseLeftButtonUp="OnMouseLeftButtonUp" x:Name="Root">
    <UserControl.Resources>
        <Converters:ValueToBrushConverter x:Key="ValueToBrushConverter"
                                 DefaultBrush="Cyan"
                                 WarningBrush="DarkViolet"
                                 DangerBrush="Red" />
    </UserControl.Resources>

    <!-- DataTriggers moved to Style.Triggers -->
    <Border CornerRadius="16" BorderThickness="4" Padding="0">
        <Border.Style>
            <Style TargetType="Border">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ServerState, ElementName=Root}" Value="Normal">
                        <Setter Property="Background" Value="{DynamicResource RegionBrush}" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ServerState, ElementName=Root}" Value="Warning">
                        <Setter Property="Background" Value="{DynamicResource WarningBrush}" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ServerState, ElementName=Root}" Value="Error">
                        <Setter Property="Background" Value="{DynamicResource DangerBrush}" />
                    </DataTrigger>

                    <!-- 선택시 -->
                    <DataTrigger Binding="{Binding IsSelected, ElementName=Root}" Value="True">
                        <Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}" />
                    </DataTrigger>

                    <DataTrigger Binding="{Binding IsSelected, ElementName=Root}" Value="False">
                        <Setter Property="BorderBrush" Value="Transparent" />
                    </DataTrigger>
                </Style.Triggers>
                <!--<Setter Property="BorderBrush" Value="Transparent" />-->
            </Style>
        </Border.Style>

        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="40" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Path Grid.RowSpan="4" Grid.ColumnSpan="4">
                <Path.Data>
                    M4,1H20A1,1 0 0,1 21,2V6A1,1 0 0,1 20,7H4A1,1 0 0,1 3,6V2A1,1 0 0,1 4,1M4,9H20A1,1 0 0,1 21,10V14A1,1 0 0,1 20,15H4A1,1 0 0,1 3,14V10A1,1 0 0,1 4,9M4,17H20A1,1 0 0,1 21,18V22A1,1 0 0,1 20,23H4A1,1 0 0,1 3,22V18A1,1 0 0,1 4,17M9,5H10V3H9V5M9,13H10V11H9V13M9,21H10V19H9V21M5,3V5H7V3H5M5,11V13H7V11H5M5,19V21H7V19H5Z
                </Path.Data>
            </Path>

            <Path Grid.RowSpan="2" Grid.ColumnSpan="2" VerticalAlignment="Bottom" HorizontalAlignment="Left"                   Width="80" Height="80" Opacity="0.2" x:Name="server_path" Fill="{DynamicResource BackgroundBrush}" Stretch="Uniform"                  Data="M4,1H20A1,1 0 0,1 21,2V6A1,1 0 0,1 20,7H4A1,1 0 0,1 3,6V2A1,1 0 0,1 4,1M4,9H20A1,1 0 0,1 21,10V14A1,1 0 0,1 20,15H4A1,1 0 0,1 3,14V10A1,1 0 0,1 4,9M4,17H20A1,1 0 0,1 21,18V22A1,1 0 0,1 20,23H4A1,1 0 0,1 3,22V18A1,1 0 0,1 4,17M9,5H10V3H9V5M9,13H10V11H9V13M9,21H10V19H9V21M5,3V5H7V3H5M5,11V13H7V11H5M5,19V21H7V19H5Z" />

            <!-- 서버명 + 상태 -->
            <Grid x:Name="HeaderGrid">

                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <TextBlock Text="DevUGame" FontSize="16"
                           FontFamily="Segoe UI Variable Text Semilight" Foreground="{DynamicResource SecondaryTextBrush}" />
                <TextBlock Text="11101" Grid.Row="1"  FontSize="18"  VerticalAlignment="Center"
                           FontFamily="Segoe UI Variable Text" Foreground="{DynamicResource PrimaryTextBrush}" />

                <Button HorizontalAlignment="Right" VerticalAlignment="Center" Padding="5" Width="20" Height="20" Style="{StaticResource ButtonIconCircular}" hc:IconElement.Geometry="{StaticResource UpDownGeometry}" />
            </Grid>

            <TextBlock FontSize="48" Grid.Row="1" Foreground="{DynamicResource PrimaryTextBrush}"
                       FontFamily="Century Gothic" VerticalAlignment="Bottom" HorizontalAlignment="Left">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Text" Value="9999" />
                        <!-- 기본값 설정 -->
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ServerState, ElementName=Root}" Value="Error">
                                <Setter Property="Text" Value="...." />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Row="1" Grid.RowSpan="2">
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Setter Property="Visibility" Value="Visible" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ServerState, ElementName=Root}" Value="Error">
                                <Setter Property="Visibility" Value="Collapsed" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>
                <ProgressBar Foreground="{Binding Value, RelativeSource={RelativeSource Self}, Converter={StaticResource ValueToBrushConverter}}"
                             Style="{StaticResource ProgressBarFlat}" Value="10" Maximum="100" Orientation="Vertical" Width="2" />
                <ProgressBar Foreground="{Binding Value, RelativeSource={RelativeSource Self}, Converter={StaticResource ValueToBrushConverter}}"
                             Style="{StaticResource ProgressBarFlat}" Value="66.2" Maximum="100" Orientation="Vertical" Width="2" Margin="2,0" />
                <ProgressBar Foreground="{Binding Value, RelativeSource={RelativeSource Self}, Converter={StaticResource ValueToBrushConverter}}"
                              Style="{StaticResource ProgressBarFlat}" Value="82.3" Maximum="100" Orientation="Vertical" Width="2" />
            </StackPanel>
        </Grid>
    </Border>
</UserControl>